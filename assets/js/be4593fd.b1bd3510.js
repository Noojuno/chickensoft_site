"use strict";(self.webpackChunkchickensoft_site=self.webpackChunkchickensoft_site||[]).push([[178],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),i=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=i(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=i(n),g=o,m=d["".concat(l,".").concat(g)]||d[g]||u[g]||r;return n?a.createElement(m,c(c({ref:t},p),{},{components:n})):a.createElement(m,c({ref:t},p))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,c=new Array(r);c[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,c[1]=s;for(var i=2;i<r;i++)c[i]=n[i];return a.createElement.apply(null,c)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6312:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>i});var a=n(7462),o=(n(7294),n(3905));const r={title:"\u267b\ufe0f Sharing PowerUps",image:"https://chickensoft.games/assets/images/header-bbf251851f04eefa5fd63323124240f2.jpg"},c=void 0,s={unversionedId:"super_nodes/advanced_usage/sharing_power_ups",id:"super_nodes/advanced_usage/sharing_power_ups",title:"\u267b\ufe0f Sharing PowerUps",description:"To share a PowerUp, we need to be able to share the code for it, not a compiled .dll of its contents. If we aren't able to share the source code for a PowerUp, the SuperNodes generator can't apply it to a SuperNode.",source:"@site/docs/super_nodes/advanced_usage/03_sharing_power_ups.md",sourceDirName:"super_nodes/advanced_usage",slug:"/super_nodes/advanced_usage/sharing_power_ups",permalink:"/docs/super_nodes/advanced_usage/sharing_power_ups",draft:!1,editUrl:"https://github.com/chickensoft-games/chickensoft_site/tree/main/docs/super_nodes/advanced_usage/03_sharing_power_ups.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"\u267b\ufe0f Sharing PowerUps",image:"https://chickensoft.games/assets/images/header-bbf251851f04eefa5fd63323124240f2.jpg"},sidebar:"tutorialSidebar",previous:{title:"\ud83e\udeab Generic PowerUps",permalink:"/docs/super_nodes/advanced_usage/generic_power_ups"},next:{title:"\ud83d\udd2c Advanced Static Reflection",permalink:"/docs/super_nodes/advanced_usage/advanced_static_reflection"}},l={},i=[{value:"\ud83d\udcd1 Source-Only Nuget Packages",id:"-source-only-nuget-packages",level:3},{value:"\ud83d\udcc4 Using a Source-Only Package",id:"-using-a-source-only-package",level:3},{value:"\ud83d\udda5 Locally",id:"-locally",level:4},{value:"\ud83d\udce6 From Nuget",id:"-from-nuget",level:4}],p={toc:i};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"To share a PowerUp, we need to be able to share the code for it, not a compiled ",(0,o.kt)("inlineCode",{parentName:"p"},".dll")," of its contents. If we aren't able to share the source code for a PowerUp, the SuperNodes generator can't apply it to a SuperNode."),(0,o.kt)("p",null,"Fortunately for us, Nuget can be used to make ",(0,o.kt)("a",{parentName:"p",href:"https://medium.com/@attilah/source-code-only-nuget-packages-8f34a8fb4738"},"source-only nuget packages"),"."),(0,o.kt)("h3",{id:"-source-only-nuget-packages"},"\ud83d\udcd1 Source-Only Nuget Packages"),(0,o.kt)("p",null,"When a project references a source only package, any source generators in the project will be able to see the contents of the source-only package and generate code from it. That's exactly what we want!"),(0,o.kt)("p",null,"SuperNodes contains an ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/chickensoft-games/SuperNodes/tree/main/SharedPowerUps"},"example of a source-only package")," that you can copy and customize to your liking. Just copy it and configure the fields in the ",(0,o.kt)("inlineCode",{parentName:"p"},".csproj")," file to match your project."),(0,o.kt)("p",null,"Any source code that the project contains will automatically get copied into the nuget package's content files for distribution, so add as many as you source files as you want!"),(0,o.kt)("h3",{id:"-using-a-source-only-package"},"\ud83d\udcc4 Using a Source-Only Package"),(0,o.kt)("p",null,"Using source-only packages is a little bit different than using a normal package."),(0,o.kt)("h4",{id:"-locally"},"\ud83d\udda5 Locally"),(0,o.kt)("p",null,"Importing source-only packages locally via ",(0,o.kt)("inlineCode",{parentName:"p"},"<ProjectReference>")," doesn't work, as the imported source is not fed to the consuming project's source generators."),(0,o.kt)("p",null,"To use a source-only PowerUp package locally, first build the project."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"cd SharedPowerUps # or wherever your source-only PowerUp project is\ndotnet build\n")),(0,o.kt)("p",null,"Add a ",(0,o.kt)("inlineCode",{parentName:"p"},"nuget.config")," alongside your solution file for the project in which you want to import your source-only PowerUp package."),(0,o.kt)("p",null,"In the ",(0,o.kt)("inlineCode",{parentName:"p"},"nuget.config")," file, add a key (any name will work) with the value containing the path to your source-only PowerUp package:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="utf-8"?>\n<configuration>\n  <config>\n  </config>\n  <settings>\n  </settings>\n  <packageSources>\n    <add key="Local Packages" value="/Somewhere/LocalPackages" />\n  </packageSources>\n</configuration>\n')),(0,o.kt)("p",null,"The path in the ",(0,o.kt)("inlineCode",{parentName:"p"},"nuget.config")," to the local package should be the same as the ",(0,o.kt)("inlineCode",{parentName:"p"},"<OutputPath>")," in the source-only PowerUp package's ",(0,o.kt)("inlineCode",{parentName:"p"},"*.csproj")," file (or you can manually move your source-only package ",(0,o.kt)("inlineCode",{parentName:"p"},".nupkg")," to your local package storage path specified in your ",(0,o.kt)("inlineCode",{parentName:"p"},"nuget.config"),")."),(0,o.kt)("p",null,"Finally, in your project that wants to use the source-only package, add a ",(0,o.kt)("inlineCode",{parentName:"p"},"<PackageReference>")," to the source-only package as shown below (make sure to replace the name with your source-only package's name)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<ItemGroup>\n  <PackageReference Include="SharedPowerUps" Version="1.0.0" PrivateAssets="all" />\n</ItemGroup>\n')),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"You must include ",(0,o.kt)("inlineCode",{parentName:"p"},'PrivateAssets="all"'),".")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"nuget.config")," file will instruct the ",(0,o.kt)("inlineCode",{parentName:"p"},"dotnet")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"nuget")," tool to resolve your package from the local path correctly."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"If you make changes to your source-only PowerUp package, ",(0,o.kt)("inlineCode",{parentName:"p"},"dotnet restore")," will not always pick up on the changes. To force your project to clear its package cache, run the following:"),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"cd your_project_using_a_source_only_package\ndotnet nuget locals --clear all\ndotnet build\n"))),(0,o.kt)("h4",{id:"-from-nuget"},"\ud83d\udce6 From Nuget"),(0,o.kt)("p",null,"If you've successfully published your source-only package, using it should be as simple as adding the following to your project:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csproj"},'<ItemGroup>\n  <PackageReference Include="MySharedPowerUps" Version="1.0.0" PrivateAssets="all" />\n</ItemGroup>\n')))}u.isMDXComponent=!0}}]);